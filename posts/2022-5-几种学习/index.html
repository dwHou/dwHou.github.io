<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.loli.net/css?family=PT+Serif:400,400italic,700,700italic&subset=latin,cyrillic-ext,cyrillic,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; tab-size: 4; background-position: inherit; background-repeat: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror-linenumber { }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit; background-repeat: inherit; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; background-position: 0px 0px; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; padding-bottom: 0px !important; }
  .typora-export * { print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background-color: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; }
a.md-print-anchor { white-space: pre !important; border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; text-shadow: initial !important; background-position: 0px 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background-color: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit; background-repeat: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.428571429rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left-width: 28px; border-left-style: solid; border-left-color: transparent; border-right-width: 28px; border-right-style: solid; border-right-color: transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right-width: 8px; border-right-style: solid; border-right-color: transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


/* meyer reset -- http://meyerweb.com/eric/tools/css/reset/ , v2.0 | 20110126 | License: none (public domain) */

@include-when-export url(https://fonts.loli.net/css?family=PT+Serif:400,400italic,700,700italic&subset=latin,cyrillic-ext,cyrillic,latin-ext);

/* =========== */

/* pt-serif-regular - latin */
/* pt-serif-italic - latin */
/* pt-serif-700 - latin */
/* pt-serif-700italic - latin */
:root {
	--active-file-bg-color: #dadada;
	--active-file-bg-color: rgba(32, 43, 51, 0.63);
	--active-file-text-color: white;
	--bg-color: #f3f2ee;
	--text-color: #1f0909;
	--control-text-color: #444;
	--rawblock-edit-panel-bd: #e5e5e5;

	--select-text-bg-color: rgba(32, 43, 51, 0.63);
  --select-text-font-color: white;
}

pre {
	--select-text-bg-color: #36284e;
	--select-text-font-color: #fff;
}

html {
	font-size: 16px;
	-webkit-font-smoothing: antialiased;
}

html, body {
	background-color: #f3f2ee;
	font-family: "PT Serif", 'Times New Roman', Times, serif;
	color: #1f0909;
	line-height: 1.5em;
}

/*#write {
	overflow-x: auto;
    max-width: initial;
	padding-left: calc(50% - 17em);
    padding-right: calc(50% - 17em);
}

@media (max-width: 36em) {
 	#write {
 		padding-left: 1em;
    	padding-right: 1em;
 	}
}*/

#write {
	max-width: 40em;
}

@media only screen and (min-width: 1400px) {
	#write {
			max-width: 914px;
	}
}

ol li {
	list-style-type: decimal;
	list-style-position: outside;
}
ul li {
	list-style-type: disc;
	list-style-position: outside;
}

ol,
ul {
	list-style: none;
}

blockquote,
q {
	quotes: none;
}
blockquote:before,
blockquote:after,
q:before,
q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}
/* styles */

/* ====== */

/* headings */

h1,
h2,
h3,
h4,
h5,
h6 {
	font-weight: bold;
}
h1 {
	font-size: 1.875em;
	/*30 / 16*/
	line-height: 1.6em;
	/* 48 / 30*/
	margin-top: 2em;
}
h2,
h3 {
	font-size: 1.3125em;
	/*21 / 16*/
	line-height: 1.15;
	/*24 / 21*/
	margin-top: 2.285714em;
	/*48 / 21*/
	margin-bottom: 1.15em;
	/*24 / 21*/
}
h3 {
	font-weight: normal;
}
h4 {
	font-size: 1.125em;
	/*18 / 16*/
	margin-top: 2.67em;
	/*48 / 18*/
}
h5,
h6 {
	font-size: 1em;
	/*16*/
}
h1 {
	border-bottom: 1px solid;
	margin-bottom: 1.875em;
	padding-bottom: 0.8125em;
}
/* links */

a {
	text-decoration: none;
	color: #065588;
}
a:hover,
a:active {
	text-decoration: underline;
}
/* block spacing */

p,
blockquote,
.md-fences {
	margin-bottom: 1.5em;
}
h1,
h2,
h3,
h4,
h5,
h6 {
	margin-bottom: 1.5em;
}
/* blockquote */

blockquote {
	font-style: italic;
	border-left: 5px solid;
	margin-left: 2em;
	padding-left: 1em;
}
/* lists */

ul,
ol {
	margin: 0 0 1.5em 1.5em;
}
/* tables */
.md-meta,.md-before, .md-after {
	color:#999;
}

table {
	margin-bottom: 1.5em;
	/*24 / 16*/
	font-size: 1em;
	/* width: 100%; */
}
thead th,
tfoot th {
	padding: .25em .25em .25em .4em;
	text-transform: uppercase;
}
th {
	text-align: left;
}
td {
	vertical-align: top;
	padding: .25em .25em .25em .4em;
}

code,
.md-fences {
	background-color: #dadada;
}

code {
	padding-left: 2px;
	padding-right: 2px;
}

.md-fences {
	margin-left: 2em;
	margin-bottom: 3em;
	padding-left: 1ch;
	padding-right: 1ch;
}

pre,
code,
tt {
	font-size: .875em;
	line-height: 1.714285em;
}
/* some fixes */

h1 {
	line-height: 1.3em;
	font-weight: normal;
	margin-bottom: 0.5em;
}

p + ul,
p + ol{
	margin-top: .5em;
}

h3 + ul,
h4 + ul,
h5 + ul,
h6 + ul,
h3 + ol,
h4 + ol,
h5 + ol,
h6 + ol {
	margin-top: .5em;
}

li > ul,
li > ol {
	margin-top: inherit;
	margin-bottom: 0;
}

li ol>li {
	list-style-type: lower-alpha;
}

li li ol>li{
	list-style-type: lower-roman;
}

h2,
h3 {
	margin-bottom: .75em;
}
hr {
	border-top: none;
	border-right: none;
	border-bottom: 1px solid;
	border-left: none;
}
h1 {
	border-color: #c5c5c5;
}
blockquote {
	border-color: #bababa;
	color: #656565;
}

blockquote ul,
blockquote ol {
	margin-left:0;
}

.ty-table-edit {
	background-color: transparent;
}
thead {
	background-color: #dadada;
}
tr:nth-child(even) {
	background: #e8e7e7;
}
hr {
	border-color: #c5c5c5;
}
.task-list{
	padding-left: 1rem;
}

.md-task-list-item {
	padding-left: 1.5rem;
	list-style-type: none;
}

.md-task-list-item > input:before {
	content: '\221A';
	display: inline-block;
	width: 1.25rem;
  	height: 1.6rem;
	vertical-align: middle;
	text-align: center;
	color: #ddd;
	background-color: #F3F2EE;
}

.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before{
	color: inherit;
}

#write pre.md-meta-block {
	min-height: 1.875rem;
	color: #555;
	border: 0px;
	background: transparent;
	margin-top: -4px;
	margin-left: 1em;
	margin-top: 1em;
}

.md-image>.md-meta {
	color: #9B5146;
}

.md-image>.md-meta{
	font-family: Menlo, 'Ubuntu Mono', Consolas, 'Courier New', 'Microsoft Yahei', 'Hiragino Sans GB', 'WenQuanYi Micro Hei', serif;
}


#write>h3.md-focus:before{
	left: -1.5rem;
	color:#999;
	border-color:#999;
}
#write>h4.md-focus:before{
	left: -1.5rem;
	top: .25rem;
	color:#999;
	border-color:#999;
}
#write>h5.md-focus:before{
	left: -1.5rem;
	top: .0.3125rem;
	color:#999;
	border-color:#999;
}
#write>h6.md-focus:before{
	left: -1.5rem;
	top: 0.3125rem;
	color:#999;
	border-color:#999;
}

.md-toc:focus .md-toc-content{
	margin-top: 19px;
}

.md-toc-content:empty:before{
	color: #065588;
}
.md-toc-item {
	color: #065588;
}
#write div.md-toc-tooltip {
	background-color: #f3f2ee;
}

#typora-sidebar {
	background-color: #f3f2ee;
	-webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.375);
  	box-shadow: 0 6px 12px rgba(0, 0, 0, 0.375);
}

.pin-outline #typora-sidebar {
	background: inherit;
	box-shadow: none;
	border-right: 1px dashed;
}

.pin-outline #typora-sidebar:hover .outline-title-wrapper {
	border-left:1px dashed;
}

.outline-item:hover {
  background-color: #dadada;
  border-left: 28px solid #dadada;
  border-right: 18px solid #dadada;
}

.typora-node .outline-item:hover {
  	border-right: 28px solid #dadada;
}

.outline-expander:before {
  content: "\f0da";
  font-family: FontAwesome;
  font-size:14px;
  top: 1px;
}

.outline-expander:hover:before,
.outline-item-open>.outline-item>.outline-expander:before {
  content: "\f0d7";
}

.modal-content {
	background-color: #f3f2ee;
}

.auto-suggest-container ul li {
	list-style-type: none;
}

/** UI for electron */

.megamenu-menu,
#top-titlebar, #top-titlebar *,
.megamenu-content {
	background: #f3f2ee;
	color: #1f0909;
}

.megamenu-menu-header {
	border-bottom: 1px dashed #202B33;
}

.megamenu-menu {
	box-shadow: none;
	border-right: 1px dashed;
}

header, .context-menu, .megamenu-content, footer {
	font-family: "PT Serif", 'Times New Roman', Times, serif;
    color: #1f0909;
}

#megamenu-back-btn {
	color: #1f0909;
	border-color: #1f0909;
}

.megamenu-menu-header #megamenu-menu-header-title:before {
	color: #1f0909;
}

.megamenu-menu-list li a:hover, .megamenu-menu-list li a.active {
	color: inherit;
	background-color: #e8e7df;
}

.long-btn:hover {
	background-color: #e8e7df;
}

#recent-file-panel tbody tr:nth-child(2n-1) {
    background-color: transparent !important;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(2) {
    color: inherit;
}

.megamenu-menu-panel .btn {
	background-color: #D2D1D1;
}

.btn-default {
	background-color: transparent;
}

.typora-sourceview-on #toggle-sourceview-btn,
.ty-show-word-count #footer-word-count {
	background: #c7c5c5;
}

#typora-quick-open {
    background-color: inherit;
}

.md-diagram-panel {
	margin-top: 8px;
}

.file-list-item-file-name {
	font-weight: initial;
}

.file-list-item-summary {
	opacity: 1;
}

.file-list-item {
	color: #777;
}

.file-list-item.active {
	background-color: inherit;
	color: black;
}

.ty-side-sort-btn.active {
	background-color: inherit;
}

.file-list-item.active .file-list-item-file-name  {
	font-weight: bold;
}

.file-list-item{
    opacity:1 !important;
}

.file-library-node.active>.file-node-background{
	background-color: rgba(32, 43, 51, 0.63);
	background-color: var(--active-file-bg-color);
}

.file-tree-node.active>.file-node-content{
	color: white;
	color: var(--active-file-text-color);
}

.md-task-list-item>input {
	margin-left: -1.7em;
	margin-top: calc(1rem - 12px);
	-webkit-appearance: button;
}

input {
	border: 1px solid #aaa;
}

.megamenu-menu-header #megamenu-menu-header-title,
.megamenu-menu-header:hover, 
.megamenu-menu-header:focus {
	color: inherit;
}

.dropdown-menu .divider {
	border-color: #e5e5e5;
	opacity: 1;
}

/* https://github.com/typora/typora-issues/issues/2046 */
.os-windows-7 strong,
.os-windows-7 strong  {
	font-weight: 760;
}

.ty-preferences .btn-default {
	background: transparent;
}

.ty-preferences .window-header {
	border-bottom: 1px dashed #202B33;
	box-shadow: none;
}

#sidebar-loading-template, #sidebar-loading-template.file-list-item {
	color: #777;
}

.searchpanel-search-option-btn.active {
	background: #777;
	color: white;
}

.export-detail, .light .export-detail, 
.light .export-item.active, 
.light .export-items-list-control {
	background: #e0e0e0;
	border-radius: 2px;
	font-weight: 700;
	color: inherit
}


mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
							stroke-width: 0;
						} @media print { @page {margin: 0 0 0 0;} body.typora-export {padding-left: 0; padding-right: 0;} #write {padding:0;}}
</style><title>对比学习</title>
</head>
<body class='typora-export typora-export-show-outline typora-export-no-collapse-outline'><div class='typora-export-content'>
<div class="typora-export-sidebar"><div class="outline-content"><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#对比学习和稳定学习">对比学习和稳定学习</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#对比学习">对比学习</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#第一阶段百花齐放-18年19年中）">第一阶段：百花齐放 （18年~19年中）</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#instdisc">InstDisc </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#invaspread">InvaSpread </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#cpc">CPC  </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#cmc">CMC </a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#第二阶段cv双雄-19年中20年中）">第二阶段：CV双雄 （19年中~20年中）</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#mocov1">MoCov1 </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#simclrv1">SimCLRv1 </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#mocov2">MoCov2</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#simclrv2">SimCLRv2 </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#swav">SwAV </a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#第三阶段不用负样本">第三阶段：不用负样本</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#byol">BYOL </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#针对byol的博客和他们的回应">针对BYOL的博客和他们的回应 </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#simsiam">SimSiam </a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#第四阶段基于transformer">第四阶段：基于Transformer </a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#mocov3">MoCov3 </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#dino">DINO </a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#总结">总结</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#术语">术语</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h2 outline-item-open"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#底层视觉中的对比学习">底层视觉中的对比学习</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#因果推理和稳定学习">因果推理和稳定学习</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#背景">背景</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#现状分析">现状分析</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#相互关系">相互关系</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#因果模型和基于学习的模型">因果模型和基于学习的模型</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#因果推断">因果推断</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#第一种范式">第一种范式</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#第二种范式">第二种范式</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#范式下的几种方法">范式下的几种方法</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#"> </a></div><ul class="outline-children"></ul></li></ul></li></ul></li></ul></li></div></div><div id='write'  class=''><h1 id='对比学习和稳定学习'><span>对比学习和稳定学习</span></h1><p>&nbsp;</p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n0"><a class="md-toc-inner" href="#对比学习和稳定学习">对比学习和稳定学习</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n4"><a class="md-toc-inner" href="#对比学习">对比学习</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n6"><a class="md-toc-inner" href="#第一阶段百花齐放-18年19年中）">第一阶段：百花齐放 （18年~19年中）</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n7"><a class="md-toc-inner" href="#instdisc">InstDisc </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n29"><a class="md-toc-inner" href="#invaspread">InvaSpread </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n52"><a class="md-toc-inner" href="#cpc">CPC  </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n72"><a class="md-toc-inner" href="#cmc">CMC </a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n90"><a class="md-toc-inner" href="#第二阶段cv双雄-19年中20年中）">第二阶段：CV双雄 （19年中~20年中）</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n91"><a class="md-toc-inner" href="#mocov1">MoCov1 </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n152"><a class="md-toc-inner" href="#simclrv1">SimCLRv1 </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n187"><a class="md-toc-inner" href="#mocov2">MoCov2</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n200"><a class="md-toc-inner" href="#simclrv2">SimCLRv2 </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n211"><a class="md-toc-inner" href="#swav">SwAV </a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n236"><a class="md-toc-inner" href="#第三阶段不用负样本">第三阶段：不用负样本</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n237"><a class="md-toc-inner" href="#byol">BYOL </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n255"><a class="md-toc-inner" href="#针对byol的博客和他们的回应">针对BYOL的博客和他们的回应 </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n330"><a class="md-toc-inner" href="#simsiam">SimSiam </a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n354"><a class="md-toc-inner" href="#第四阶段基于transformer">第四阶段：基于Transformer </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n355"><a class="md-toc-inner" href="#mocov3">MoCov3 </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n374"><a class="md-toc-inner" href="#dino">DINO </a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n393"><a class="md-toc-inner" href="#总结">总结</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n395"><a class="md-toc-inner" href="#术语">术语</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n402"><a class="md-toc-inner" href="#底层视觉中的对比学习">底层视觉中的对比学习</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n415"><a class="md-toc-inner" href="#因果推理和稳定学习">因果推理和稳定学习</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n416"><a class="md-toc-inner" href="#背景">背景</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n417"><a class="md-toc-inner" href="#现状分析">现状分析</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n421"><a class="md-toc-inner" href="#相互关系">相互关系</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n432"><a class="md-toc-inner" href="#因果模型和基于学习的模型">因果模型和基于学习的模型</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n442"><a class="md-toc-inner" href="#因果推断">因果推断</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n443"><a class="md-toc-inner" href="#第一种范式">第一种范式</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n445"><a class="md-toc-inner" href="#第二种范式">第二种范式</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n455"><a class="md-toc-inner" href="#范式下的几种方法">范式下的几种方法</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n477"><a class="md-toc-inner" href="#"> </a></span></p></div><h2 id='对比学习'><span>对比学习</span></h2><p>&nbsp;</p><h4 id='第一阶段百花齐放-18年19年中）'><span>第一阶段：百花齐放 （18年~19年中）</span></h4><h5 id='instdisc'><span>InstDisc </span></h5><p><span>Instance Discrimination是巨人的肩膀。</span></p><ul><li><span>启发：视觉相似的东西在分类器的分数比较高，比如猎豹的输入，雪豹也会分数比较高。</span></li><li><span>代理任务：提出个体判别任务。希望每个图片都是自己的类，和其他图片尽量地分开。</span></li><li><span>对比学习</span></li><li><span>正样本：原图片本身，可以经过一些数据增强</span></li><li><span>负样本：数据集里所有其他图片</span></li><li><span>要点：大量负样本特征存在哪儿？解决：Memory Bank的形式，即存在字典里。</span></li><li><span>细节：ImageNet有128万张图片，那么这个字典有128万行，所以每个维度不能太高，128维。训练时每次从字典里随机抽4096个负样本，并且更新正样本。最后使得这个128维特征尽可能有区分性。目标函数NCE loss。</span></li><li><img src="../../images/typora-images/image-20220425102437461.png" alt="image-20220425102437461" style="zoom:50%;" /></li><li><span>总结关键词：里程碑；超参数；个体判别任务；无监督表征学习</span></li></ul><p>&nbsp;</p><h5 id='invaspread'><span>InvaSpread </span></h5><p><span>Invariant and Spreading可以理解是SimCLR的前身。</span></p><ul><li><p><span>启发：同样的图片经过不同数据增强，出来的特征应该类似，不同图片则应该不类似。</span></p></li><li><p><span>代理任务：个体判别任务</span></p></li><li><p><span>对比学习 </span></p></li><li><p><span>正样本： 原图片或其数据增强</span></p></li><li><p><span>负样本： 同一个mini-batch里其他所有图片</span></p></li><li><p><span>要点：同一个mini-batch里选择正负样本，可以端到端学习了。 一个编码器，不需要外部的数据结构去存储大量负样本。 </span></p></li><li><p><span>细节：仍然是要求和正样本low-dim特征尽可能接近，和负样本尽可能拉远。目标函数NCE loss的一个变体。</span></p></li><li><p><span>总结关键词：端到端学习</span></p><p><img src="../../images/typora-images/image-20220425105537566.png" alt="image-20220425105537566" style="zoom:50%;" /></p></li></ul><p><span>问：为什么同样是端到端学习，它没有取得SimCLR那么好的效果呢？</span></p><p><span>答： MoCo论文反复强调的，负样本最好是足够多。而本文作者是没有TPU的，它的batchsize只有256，意味着它的负样本只有(256-1)x2个。 再加上缺少SimCLR那么强大的数据增广，以及最后提出的mlp projector。</span></p><p>&nbsp;</p><h5 id='cpc'><span>CPC  </span></h5><p><span>Contrastive Predictive Coding（对比预测编码）用在了生成式的代理任务，是一个很通用的结构。</span></p><ul><li><p><span>启发：</span></p></li><li><p><span>代理任务： 不同于前面两篇的判别式范畴的，本文则研究预测型的代理任务，属于生成式范畴。</span></p></li><li><p><span>对比学习</span></p></li><li><p><span>正样本：未来时刻的输入</span></p></li><li><p><span>负样本：任意选取输入</span></p></li><li><p><span>要点： </span></p></li><li><p><span>细节：</span></p></li><li><p><span>总结关键词：预测型；各种模态通用</span></p><p>&nbsp;</p></li></ul><h5 id='cmc'><span>CMC </span></h5><p><span>Contrastive Multiview Coding</span></p><ul><li><p><span>启发：人类观察世界是通过很多个传感器，每一个视角都可能是带噪声或者不完整的。但最重要的一些信息是可以在所有的这些视角中间共享的，比如基础物理定律、几何形状、语义信息。</span></p><p><span>例子：一只狗既可以被看见，也可以被听到，也可以被感受到。 </span></p><p><span>目的：学一个强大的信息，具有视角的不变性。增大所有视角之间的互信息。</span></p></li><li><p><span>代理任务：多视角多模态任务</span></p></li><li><p><span>对比学习</span></p></li><li><p><span>正样本：一个物体的很多个视角。如NYU RGBD数据集有原始图像、深度图、平面法线、分割图，这四个视角互为正样本。</span></p></li><li><p><span>负样本：不配对的视角。</span></p></li><li><p><span>要点：证明了对比学习的灵活性，证明了多视角、多模态的可行性。所以接下来① OpenAI很快出来了CLIP这个模型。② CMC原版人马做了一个基于对比学习的蒸馏方法，也就是teacher模型的输出和student模型的输出做成正样本对。③ 缺点是不同模态或者视角，可能长得不一样，需要不同的编码器。增加了训练时的计算代价。比如CLIP的文本端用的bert，图像端用的vit。但这也是transformer真正吸引人的地方，已经有人这么做了（MA CLIP），用一个transformer编码器，同时处理两个输入模态，效果反而更好。</span></p></li></ul><p>&nbsp;</p><h4 id='第二阶段cv双雄-19年中20年中）'><span>第二阶段：CV双雄 （19年中~20年中）</span></h4><h5 id='mocov1'><span>MoCov1 </span></h5><p><span>Momentum Contrast动量对比学习</span></p><ul><li><p><span>启发：从字典查询的角度来看待对比学习。</span><strong><span>很大的、一致的</span></strong><span>字典对无监督对比学习有好处。</span></p></li><li><p><span>代理任务：个体判别任务</span></p></li><li><p><span>对比学习：简单、好用、强大，盘活了计算机视觉领域</span></p><p><span>可以看作动态字典</span></p><p><img src="../../images/typora-images/image-20220425164823422.png" alt="image-20220425164823422" style="zoom:50%;" /></p></li><li><p><span>正样本：</span></p></li><li><p><span>负样本：</span></p></li><li><p><span>难点：无监督表征学习在nlp领域很成功（GPT、BERT），但在视觉领域就远不如有监督，因为视觉的原始信号是在一个连续、高维的空间并且没有很强的结构语义信息（不像单词）。</span></p></li><li><p><span>前人工作的不足：</span></p><ul><li><p><span>end-to-end：query和key都来自同一个batch。虽然一致性很强，但受限于字典大小。SimCLR就是这种，因为Google有TPU，batchsize上到了8192。</span></p></li><li><p><span>memory bank：字典可以很大，比如InstDisc，但由于模型更新后，对于这批用到的key会得到新的key放回去。一致性就很差。</span></p><p><img src="../../images/typora-images/image-20220426145128472.png" alt="image-20220426145128472" style="zoom:30%;" /></p></li></ul></li><li><p><span>要点：</span></p><ul><li><p><span>特征空间、表征空间（embedding space）的正样本拉近，负样本远离。不需要标签信息。</span></p><p><span>问：要知道哪些样本相似/不相似，不还是需要标签信息么？</span></p><p><span>答：视觉领域大家设计一些巧妙的代理任务，从而人为的定义一些规则，这些规则可以用来定义哪些图片是相似的或不相似的。这也是所谓的自监督训练。规则的定义可以很灵活的开脑洞，如CLIP。</span></p></li><li><p><strong><span>动量</span></strong><span>在数学上可以理解为加权移动平均。说白了，不希望当前时刻的输出完全倚赖当前时刻的输入，让之前的输出也来凑凑热闹。MoCo就是利用动量的这一特性从而缓慢地更新编码器，使得学习到的字典中的特征尽可能地保持一致。 </span></p><p><img src="../../images/typora-images/image-20220426145520160.png" alt="image-20220426145520160" style="zoom:50%;" /></p></li><li><p><span>效果好：使用普遍采用的linear protocol去测试的话，超越了之前所有无监督学习方法。更重要的是，MoCo学到的特征是能够很好地迁移到下游任务的。</span></p><p><span>注：linear protocol即冻住骨干网络（backbone），只学习最后的全连接层（分类头）。 </span></p></li><li><p><span>队列：最新的mini-batch进入队列，而最老的mini-batch出队列。这样可以把字典大小和mini-batch的大小剥离开。不然字典太大，显卡是吃不消的。</span></p></li><li><p><strong><span>队列+动量</span></strong><span>：队列能解决字典大小的问题，但这样会使得字典的一致性变差（因为从不同时刻的编码器抽取特征）。所以使用动量编码器。  </span></p></li><li><p><span>损失函数：和一个固定目标进行重建式（L1 or L2）、判别式（eight positions）、对抗式（Adversarial）的损失。而对比学习的目标是不断改变（on-the-fly）的，某种形式的</span><strong><span>对比学习目标函数</span></strong><span>和特定</span><strong><span>代理任务</span></strong><span>是配对使用的。</span></p></li><li><p><strong><span>InfoNCE</span></strong><span>：以ImageNet上做个体判别为例，如果用CE loss，相当于softmax要出来128万类，这是工作不了的。NCE（noise contrastive estimation）就把128w类的分类问题，简化为正负样本的二分类问题，从而还是可以开心的工作。至于近似（estimation），是指只从128w里选一部分做负样本好了，当然这个样本越多越好。不过Kaiming认为二分类还是不太好，毕竟负样本之间也是有差距的，所以最后其实还是用的CE loss，K个负样本就作为K+1类，只不过起名InfoNCE并加以解释。</span></p></li></ul><p>&nbsp;</p></li><li><p><span>细节：MoCo还实验了把IN-1M数据集（ImageNet-一百万）换成IG-1B（Instagram-十亿）。但提升没有那么大，① Kaiming等人认为可能是要找到</span><strong><span>更合适的代理任务</span></strong><span>，比如类似nlp的完形填空。</span></p><p><span>在两年后，Kaiming提出了MAE：mask auto-encoding。② 使用Linear Classification Protocol的方式迁移到下游任务时，grid search出来</span><strong><span>学习率最佳是30</span></strong><span>！这是很不可思议的，很少有人设比1大的学习率。Kaiming认为该现象说明无监督学习学到的特征分布，和有监督学习的特征分布是非常不一样的。</span></p></li><li><p><strong><span>Keywords：里程碑；CVPR最佳论文提名；无监督/自监督学习；迁移下游任务；动量；队列</span></strong></p></li><li><p><img src="../../images/typora-images/image-20220425165439733.png" alt="image-20220425165439733" style="zoom:50%;" /></p></li><li><p><span>意义：</span></p><blockquote><p><span>Yann LeCun：强化学习是蛋糕顶上缀着的一颗樱桃，监督学习是蛋糕表面的糖霜，虽然现在的人工智能看起来很漂亮，但人类对如何制作蛋糕胚本身——无监督学习，还是摸不着门路。</span></p></blockquote><p><span>超越了有监督预训练的模型，给视觉领域吃了一颗定心丸：无监督真的可以。我们真的不需要大规模标好的数据去做预训练。</span><font color="red"><span>MoCo可以学到很好的特征，然后这个特征具有很好的迁移性</span></font><span>，意味着无监督和有监督的表征学习中间的鸿沟已经填上了。</span></p><p>&nbsp;</p></li></ul><h5 id='simclrv1'><span>SimCLRv1 </span></h5><p><span>Simple Contrastive Learning</span></p><ul><li><p><span>启发：</span></p></li><li><p><span>代理任务：</span></p></li><li><p><span>对比学习</span></p></li><li><p><span>正样本：N</span></p></li><li><p><span>负样本：2(N-1)，和InvaSpread一样。</span></p></li><li><p><span>要点：</span></p><ul><li><p><span>f(·)共享权重，也就是只有一个编码器；SimCLR的一个重大创新点是在这个h特征之后又加了MLP层</span><font color="red"><span>g(·)</span></font><span>，直接提点10个点；</span></p><p><img src="../../images/typora-images/image-20220426160657079.png" alt="image-20220426160657079" style="zoom:50%;" /></p><p><span>可以看到① 加上g(·)提升10个点，② 其实z最后的维度是多少没有太大影响，所以对比学习现在都学一个比较低的特征维度，③ g(·)里加上relu更好一点</span></p></li><li><p><span>理解为有了特征hi做一个非线性变换得到另一个特征zi。而zi是用来做对比学习的特征。g(·)只在训练的时候用，而在迁移到下游任务时，是扔掉的。</span></p></li></ul><p><img src="../../images/typora-images/image-20220426154512336.png" alt="image-20220426154512336" style="zoom:50%;" /></p><ul><li><p><span>损失函数仍然类似InfoNCE，MoCo和SimCLR是同一时期的工作，并且互相引用。</span></p></li><li><p><span>更多数据增强</span></p><p><img src="../../images/typora-images/image-20220426160442405.png" alt="image-20220426160442405" style="zoom:50%;" /></p></li></ul><p><img src="../../images/typora-images/image-20220426160515227.png" alt="image-20220426160515227" style="zoom:50%;" /></p></li><li><p><span>细节：</span></p></li><li><p><strong><span>Keywords：简单；MLP projector；数据增强；大batch size + LARS优化器；学习更久</span></strong></p><p>&nbsp;</p></li></ul><h5 id='mocov2'><span>MoCov2</span></h5><p><span>只有两页的一个技术报告。</span></p><ul><li><p><span>启发：把SimCLR里比较好用的两个技术搬到MoCo上。</span></p></li><li><p><span>要点：MoCo + MLP projector + more data augmentation</span></p></li><li><p><span>细节：</span></p><p><img src="../../images/typora-images/image-20220426161540800.png" referrerpolicy="no-referrer" alt="image-20220426161540800"></p></li><li><p><span>总结关键词：MoCov2</span></p><p>&nbsp;</p></li></ul><h5 id='simclrv2'><span>SimCLRv2 </span></h5><p><span>SimCLRv2只是论文一个很小的部分，大部分内容在讲如何做半监督。</span></p><p><span>对比学习只占第三页半页的篇幅。</span></p><ul><li><span>要点：SimCLR + 换更大的骨干网络 + 两层MLP projector + 动量编码器</span></li><li><span>细节：</span></li><li><span>总结关键词：SimCLRv2</span></li></ul><p>&nbsp;</p><h5 id='swav'><span>SwAV </span></h5><p><span>Swapping Assignments between Views</span></p><ul><li><p><span>启发：</span></p><ul><li><strong><span>对比学习和聚类的方法结合在一起</span></strong><span>。这个想法不是偶然，因为聚类的方法也是一种无监督学习的方式，也是希望相似的物体在某一个聚类中心附近，不相似的推开。</span></li><li><span>认为之前的CL方法拿特征和特征去做这个对比，有点原始也有点费资源。能不能和聚类中心比。</span></li></ul></li><li><p><span>正样本：Multi-Crop得到。</span></p></li><li><p><span>要点：</span></p><ul><li><p><span>有了Z1、Z2后，不是在特征上做对比学习的损失。而是通过一个Clustering的方法，让特征Z生成一个目标Q。如果X1和X2是正样本，Z1和Z2就应该很相似，按道理说互相可以做预测。即：</span></p><p><span>Z1 * C能预测Q2，Z2 * C能预测Q1</span></p></li></ul><p><img src="../../images/typora-images/image-20220426170010747.png" referrerpolicy="no-referrer" alt="image-20220426170010747"></p></li><li><p><span>细节：正样本使用了Multi-Crop的技术。以往的工作resize到256，crop2x224，本论文提出crop2x160+4x96，计算量差不多的情况下正样本更多。并且全局（160）和局部（96）特征都关注。</span></p><p><span>分析下来，聚类和MoCo v2比起来并没有什么优势，真正提点的是Multi-Crop这个技术。</span></p></li><li><p><span>总结关键词：聚类中心；SOTA；Multi-Crop</span></p></li></ul><p>&nbsp;</p><h4 id='第三阶段不用负样本'><span>第三阶段：不用负样本</span></h4><h5 id='byol'><span>BYOL </span></h5><p><span>Bootstrap Your Own Latent</span></p><p><span>(Feature、Hidden、Embedding、Latent都是特征的意思，就是各种花里胡哨的用法而已。)</span></p><ul><li><p><span>代理任务：预测型任务，一个视角的特征预测另外一个视角的特征。</span></p></li><li><p><span>正样本：</span></p></li><li><p><span>负样本：如果没有负样本，模型可能会学习</span><font color="red"><span>捷径解</span></font><span>，躺平了，不论什么输入都同一种输出，loss永远是0。所以负样本在对比学习里是个必须的东西。</span></p></li><li><p><span>细节：</span></p><p><img src="../../images/typora-images/image-20220502151535169.png" alt="image-20220502151535169" style="zoom:10%;" /><span> （原论文图）</span></p><p><img src="../../images/typora-images/image-20220502203622910.png" alt="image-20220502203622910" style="zoom:50%;" /></p></li></ul><p><span>使用动量编码器，sg表示stop-gradient即detach掉，</span><font color="red"><span>MLP projector里使用BN层</span></font><span>，使用MSE loss，和别的工作一样训练完成后只需留下fθ，其他可以舍弃。</span></p><ul><li><span>总结关键词：无需负样本；BN层很关键；MSE loss；stop-gradient</span></li></ul><h5 id='针对byol的博客和他们的回应'><span>针对BYOL的</span><a href='https://generallyintelligent.ai/blog/2020-08-24-understanding-self-supervised-contrastive-learning/'><span>博客</span></a><span>和他们的回应 </span></h5><ul><li><p><span>发现：有人在复现BYOL时发现仍然出现了模型坍塌，但他相信DeepMind的工作，开始从自己的复现代码找问题，发现问题出在BN层。因为MoCo的codebase很好，他们复现BYOL时沿用了MoCo的仓库。但是MoCo的网络里是不使用BN层的。</span></p><p><img src="../../images/typora-images/image-20220502201221842.png" alt="image-20220502201221842" style="zoom:30%;" /><span>（SimCLR）  </span><img src="../../images/typora-images/image-20220502201354943.png" alt="image-20220502201354943" style="zoom:30%;" /><span>（MoCo v2）</span><img src="../../images/typora-images/image-20220502201540830.png" alt="image-20220502201540830" style="zoom:30%;" /><span>（BYOL）</span></p><figure><table><thead><tr><th><span>Name</span></th><th><span>Projection MLP Norm</span></th><th><span>Prediction MLP Norm</span></th><th><span>Loss Function</span></th><th><span>Contrastive</span></th><th><span>Performance </span><a href='https://generallyintelligent.ai/blog/2020-08-24-understanding-self-supervised-contrastive-learning/#fn-5'><span>5</span></a></th></tr></thead><tbody><tr><td><span>Contrastive Loss</span></td><td><span>None</span></td><td><span>None</span></td><td><span>Cross Entropy</span></td><td><span>Explicit</span></td><td><span>44.1</span></td></tr><tr><td><span>BYOL</span></td><td><span>Batch Norm</span></td><td><span>Batch Norm</span></td><td><span>L2</span></td><td><span>Implicit</span></td><td><span>57.7</span></td></tr><tr><td><span>Projection BN Only</span></td><td><span>Batch Norm</span></td><td><span>None</span></td><td><span>L2</span></td><td><span>Implicit</span></td><td><span>55.3</span></td></tr><tr><td><span>Prediction BN Only</span></td><td><span>None</span></td><td><span>Batch Norm</span></td><td><span>L2</span></td><td><span>Implicit</span></td><td><span>48</span></td></tr><tr><td><span>No Normalization</span></td><td><span>None</span></td><td><span>None</span></td><td><span>L2</span></td><td><span>None</span></td><td><span>28.3</span></td></tr><tr><td><span>Layer Norm</span></td><td><span>Layer Norm</span></td><td><span>Layer Norm</span></td><td><span>L2</span></td><td><span>None</span></td><td><span>29.4</span></td></tr><tr><td><span>Random</span></td><td><span>—</span></td><td><span>—</span></td><td><span>—</span></td><td><span>None</span></td><td><span>28.8</span></td></tr></tbody></table></figure></li><li><p><span>博客：</span></p><p><span>与 SimCLR 和 MoCo 等之前的工作不同，BYOL展示了一种最先进的图像表征自监督学习方法，没有明确的对比损失函数。这通过消除损失函数中对负样本的需要来简化训练。我们强调了我们在 BYOL 复现工作中的两个令人惊讶的发现：</span></p><p><strong><span>(1) BYOL 在去除批量归一化后的性能通常不比随机的好，并且</span></strong></p><p><strong><span>(2) 批量归一化的存在隐含地导致了对比学习的一种形式</span></strong><span>。</span></p><p><span>这些发现强调了在学习表征时对比正负样本的重要性，并帮助我们更基本地了解自我监督学习的工作方式和原因。</span></p></li><li><p><span>回应：</span></p><p><span>这篇博客在社区的影响力很大，也激起了BYOL作者的强烈rebuttal。因为他们认为这篇博客的解释大大降低了BYOL工作的价值。如果BYOL仍然是通过BN层里的信息隐式地利用负样本，工作的创新性就大大降低了。还是找了个东西做对比，还是脱离不了对比学习的范畴。</span></p><p><span>所以赶紧做实验，并回应了一篇BYOL works even without batch statistics，使用group norm和weight standardization也可以训好。</span></p><p><span>并且和博客作者达成了比较一致的结论：BN层和原来的设计初衷一样，主要的作用还是帮助模型稳定训练。提供模型训练稳健性，从而不模型坍塌，而不是提供负样本。</span></p><p><span>“大家不要被博客带跑偏了，赶紧来follow我们的工作吧，BYOL这个套路没有问题”</span></p><p>&nbsp;</p></li></ul><h5 id='simsiam'><span>SimSiam </span></h5><p><span>Simple Siamese （Kaiming团队再次出手）总结性的论文</span></p><ul><li><p><span>对比学习</span></p><p><img src="../../images/typora-images/image-20220502213023756.png" alt="image-20220502213023756" style="zoom:50%;" /></p></li></ul><p><span>将所有使用孪生网络（即结构一样、共享参数）</span></p><p><img src="../../images/typora-images/image-20220502214843576.png" alt="image-20220502214843576" style="zoom:36%;" /></p><p><span>主要是想说明trick全拿掉，照样能训练。论文里还有另外一个表格显示，MoCo v2和SimSiam在下游任务的</span><strong><span>迁移</span></strong><span>中效果是最好的。</span></p><ul><li><p><span>负样本：和BYOL一样，不需要用。</span></p></li><li><p><span>细节：很简单，说白也是MSE loss。p1预测z2，也可以z2预测p1。</span></p><p>&nbsp;</p><p><img src="../../images/typora-images/image-20220502212930132.png" alt="image-20220502212930132" style="zoom:36%;" /></p></li><li><p><span>贡献：</span></p><ul><li><span>对比学习的成功仿佛是很多很小的点堆起来的性能，难以分析。本作化繁为简，方便分析。</span></li><li><span>认为stop-gradient起到重要作用，可以想象成一个EM（期望最大）的算法。因为有了sg后，一个模型其实就被人为劈成了两份，解决两个子问题。不会模式坍塌。而且和SwAV聚类的思想有点像了。</span></li></ul></li></ul><p>&nbsp;</p><h4 id='第四阶段基于transformer'><span>第四阶段：基于Transformer </span></h4><h5 id='mocov3'><span>MoCov3 </span></h5><p><span>= MoCo v2 + SimSiam</span></p><ul><li><span>启发：</span></li><li><span>代理任务：</span></li><li><span>对比学习</span></li><li><span>正样本：</span></li><li><span>负样本：</span></li><li><span>难点：</span></li><li><span>细节：</span></li><li><span>总结关键词：</span></li></ul><h5 id='dino'><span>DINO </span></h5><ul><li><span>启发：</span></li><li><span>代理任务：</span></li><li><span>对比学习</span></li><li><span>正样本：</span></li><li><span>负样本：</span></li><li><span>难点：</span></li><li><span>细节：</span></li><li><span>总结关键词：</span></li></ul><p>&nbsp;</p><h4 id='总结'><span>总结</span></h4><p><a href='https://www.youtube.com/watch?v=1pvxufGRuW4'><span>Youtube</span></a></p><h4 id='术语'><span>术语</span></h4><ol start='' ><li><span>代理任务(pretext task)：一般指大家不太感兴趣的任务，没有实际应用场景，它们的提出主要是为了学习一个好的特征/数据表征。</span></li><li><span>自监督学习(self-supervised)：实际是无监督学习的一种，但大家一般混着叫，不做区分。</span></li></ol><p>&nbsp;</p><h2 id='底层视觉中的对比学习'><span>底层视觉中的对比学习</span></h2><p><span>contrastive loss 首先通过特征提取器提取 anchor， positive， negative 的特征，然后计算这三部分特征在 latent space 中的距离损失。</span></p><p><span>一般在超分辨率任务中，anchor，positive，negative 分别指网络重建图像，高分辨率图像，以及低分辨率图像通过 bicubic 上采样的结果。</span></p><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="30.193ex" height="3.738ex" role="img" focusable="false" viewBox="0 -1073.4 13345.3 1652.3" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -1.31ex;"><defs><path id="MJX-8-TEX-I-1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path id="MJX-8-TEX-I-1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-8-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-8-TEX-SO-2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path><path id="MJX-8-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-8-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-8-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-8-TEX-I-1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path><path id="MJX-8-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-8-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-8-TEX-I-1D719" d="M409 688Q413 694 421 694H429H442Q448 688 448 686Q448 679 418 563Q411 535 404 504T392 458L388 442Q388 441 397 441T429 435T477 418Q521 397 550 357T579 260T548 151T471 65T374 11T279 -10H275L251 -105Q245 -128 238 -160Q230 -192 227 -198T215 -205H209Q189 -205 189 -198Q189 -193 211 -103L234 -11Q234 -10 226 -10Q221 -10 206 -8T161 6T107 36T62 89T43 171Q43 231 76 284T157 370T254 422T342 441Q347 441 348 445L378 567Q409 686 409 688ZM122 150Q122 116 134 91T167 53T203 35T237 27H244L337 404Q333 404 326 403T297 395T255 379T211 350T170 304Q152 276 137 237Q122 191 122 150ZM500 282Q500 320 484 347T444 385T405 400T381 404H378L332 217L284 29Q284 27 285 27Q293 27 317 33T357 47Q400 66 431 100T475 170T494 234T500 282Z"></path><path id="MJX-8-TEX-I-1D44C" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path><path id="MJX-8-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-8-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJX-8-TEX-I-210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJX-8-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-8-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-8-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-8-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-8-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-8-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-8-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJX-8-TEX-I-1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D436" xlink:href="#MJX-8-TEX-I-1D436"></use></g><g data-mml-node="mi" transform="translate(760,0)"><use data-c="1D43F" xlink:href="#MJX-8-TEX-I-1D43F"></use></g><g data-mml-node="mo" transform="translate(1718.8,0)"><use data-c="3D" xlink:href="#MJX-8-TEX-N-3D"></use></g><g data-mml-node="munderover" transform="translate(2774.6,0)"><g data-mml-node="mo"><use data-c="2211" xlink:href="#MJX-8-TEX-SO-2211"></use></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-8-TEX-I-1D45B"></use></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-8-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="3D" xlink:href="#MJX-8-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-8-TEX-N-31"></use></g></g></g><g data-mml-node="msub" transform="translate(5227.9,0)"><g data-mml-node="mi"><use data-c="1D706" xlink:href="#MJX-8-TEX-I-1D706"></use></g><g data-mml-node="TeXAtom" transform="translate(616,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-8-TEX-I-1D456"></use></g></g></g><g data-mml-node="mfrac" transform="translate(6137.8,0)"><g data-mml-node="mrow" transform="translate(241.5,543.1) scale(0.707)"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-8-TEX-I-1D451"></use></g><g data-mml-node="mo" transform="translate(520,0)"><use data-c="28" xlink:href="#MJX-8-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(909,0)"><g data-mml-node="mi"><use data-c="1D719" xlink:href="#MJX-8-TEX-I-1D719"></use></g><g data-mml-node="TeXAtom" transform="translate(629,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-8-TEX-I-1D456"></use></g></g></g><g data-mml-node="mo" transform="translate(1832,0)"><use data-c="28" xlink:href="#MJX-8-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(2221,0)"><g data-mml-node="mi"><use data-c="1D44C" xlink:href="#MJX-8-TEX-I-1D44C"></use></g><g data-mml-node="TeXAtom" transform="translate(614,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-8-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(529,0)"><use data-c="1D45B" xlink:href="#MJX-8-TEX-I-1D45B"></use></g><g data-mml-node="mi" transform="translate(1129,0)"><use data-c="1D450" xlink:href="#MJX-8-TEX-I-1D450"></use></g><g data-mml-node="mi" transform="translate(1562,0)"><use data-c="210E" xlink:href="#MJX-8-TEX-I-210E"></use></g><g data-mml-node="mi" transform="translate(2138,0)"><use data-c="1D45C" xlink:href="#MJX-8-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(2623,0)"><use data-c="1D45F" xlink:href="#MJX-8-TEX-I-1D45F"></use></g></g></g><g data-mml-node="mo" transform="translate(5058.6,0)"><use data-c="29" xlink:href="#MJX-8-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(5447.6,0)"><use data-c="2C" xlink:href="#MJX-8-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(5725.6,0)"><g data-mml-node="mi"><use data-c="1D719" xlink:href="#MJX-8-TEX-I-1D719"></use></g><g data-mml-node="TeXAtom" transform="translate(629,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-8-TEX-I-1D456"></use></g></g></g><g data-mml-node="mo" transform="translate(6648.5,0)"><use data-c="28" xlink:href="#MJX-8-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(7037.5,0)"><g data-mml-node="mi"><use data-c="1D44C" xlink:href="#MJX-8-TEX-I-1D44C"></use></g><g data-mml-node="TeXAtom" transform="translate(614,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-8-TEX-I-1D45D"></use></g><g data-mml-node="mi" transform="translate(503,0)"><use data-c="1D45C" xlink:href="#MJX-8-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(988,0)"><use data-c="1D460" xlink:href="#MJX-8-TEX-I-1D460"></use></g></g></g><g data-mml-node="mo" transform="translate(8731.8,0)"><use data-c="29" xlink:href="#MJX-8-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(9120.8,0)"><use data-c="29" xlink:href="#MJX-8-TEX-N-29"></use></g></g><g data-mml-node="mrow" transform="translate(220,-370.3) scale(0.707)"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-8-TEX-I-1D451"></use></g><g data-mml-node="mo" transform="translate(520,0)"><use data-c="28" xlink:href="#MJX-8-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(909,0)"><g data-mml-node="mi"><use data-c="1D719" xlink:href="#MJX-8-TEX-I-1D719"></use></g><g data-mml-node="TeXAtom" transform="translate(629,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-8-TEX-I-1D456"></use></g></g></g><g data-mml-node="mo" transform="translate(1832,0)"><use data-c="28" xlink:href="#MJX-8-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(2221,0)"><g data-mml-node="mi"><use data-c="1D44C" xlink:href="#MJX-8-TEX-I-1D44C"></use></g><g data-mml-node="TeXAtom" transform="translate(614,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-8-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(529,0)"><use data-c="1D45B" xlink:href="#MJX-8-TEX-I-1D45B"></use></g><g data-mml-node="mi" transform="translate(1129,0)"><use data-c="1D450" xlink:href="#MJX-8-TEX-I-1D450"></use></g><g data-mml-node="mi" transform="translate(1562,0)"><use data-c="210E" xlink:href="#MJX-8-TEX-I-210E"></use></g><g data-mml-node="mi" transform="translate(2138,0)"><use data-c="1D45C" xlink:href="#MJX-8-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(2623,0)"><use data-c="1D45F" xlink:href="#MJX-8-TEX-I-1D45F"></use></g></g></g><g data-mml-node="mo" transform="translate(5058.6,0)"><use data-c="29" xlink:href="#MJX-8-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(5447.6,0)"><use data-c="2C" xlink:href="#MJX-8-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(5725.6,0)"><g data-mml-node="mi"><use data-c="1D719" xlink:href="#MJX-8-TEX-I-1D719"></use></g><g data-mml-node="TeXAtom" transform="translate(629,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-8-TEX-I-1D456"></use></g></g></g><g data-mml-node="mo" transform="translate(6648.5,0)"><use data-c="28" xlink:href="#MJX-8-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(7037.5,0)"><g data-mml-node="mi"><use data-c="1D44C" xlink:href="#MJX-8-TEX-I-1D44C"></use></g><g data-mml-node="TeXAtom" transform="translate(614,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-8-TEX-I-1D45B"></use></g><g data-mml-node="mi" transform="translate(600,0)"><use data-c="1D452" xlink:href="#MJX-8-TEX-I-1D452"></use></g><g data-mml-node="mi" transform="translate(1066,0)"><use data-c="1D454" xlink:href="#MJX-8-TEX-I-1D454"></use></g></g></g><g data-mml-node="mo" transform="translate(8792.6,0)"><use data-c="29" xlink:href="#MJX-8-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(9181.6,0)"><use data-c="29" xlink:href="#MJX-8-TEX-N-29"></use></g></g><rect width="6967.4" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>L</mi><mo>=</mo><munderover><mo data-mjx-texclass="OP">∑</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow data-mjx-texclass="ORD"><mi>n</mi></mrow></munderover><msub><mi>λ</mi><mrow data-mjx-texclass="ORD"><mi>i</mi></mrow></msub><mfrac><mrow><mi>d</mi><mo stretchy="false">(</mo><msub><mi>ϕ</mi><mrow data-mjx-texclass="ORD"><mi>i</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>Y</mi><mrow data-mjx-texclass="ORD"><mi>a</mi><mi>n</mi><mi>c</mi><mi>h</mi><mi>o</mi><mi>r</mi></mrow></msub><mo stretchy="false">)</mo><mo>,</mo><msub><mi>ϕ</mi><mrow data-mjx-texclass="ORD"><mi>i</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>Y</mi><mrow data-mjx-texclass="ORD"><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mi>d</mi><mo stretchy="false">(</mo><msub><mi>ϕ</mi><mrow data-mjx-texclass="ORD"><mi>i</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>Y</mi><mrow data-mjx-texclass="ORD"><mi>a</mi><mi>n</mi><mi>c</mi><mi>h</mi><mi>o</mi><mi>r</mi></mrow></msub><mo stretchy="false">)</mo><mo>,</mo><msub><mi>ϕ</mi><mrow data-mjx-texclass="ORD"><mi>i</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>Y</mi><mrow data-mjx-texclass="ORD"><mi>n</mi><mi>e</mi><mi>g</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></math></mjx-assistive-mml></mjx-container><script type="math/tex">CL = \sum_{i = 1}^{n}\lambda_{i}\frac{d(\phi_{i}(Y_{anchor}), \phi_{i}(Y_{pos}))}{d(\phi_{i}(Y_{anchor}), \phi_{i}(Y_{neg}))}</script></p><blockquote><p><span>where </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.195ex" height="2.236ex" role="img" focusable="false" viewBox="0 -694 970.3 988.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.666ex;"><defs><path id="MJX-9-TEX-I-1D719" d="M409 688Q413 694 421 694H429H442Q448 688 448 686Q448 679 418 563Q411 535 404 504T392 458L388 442Q388 441 397 441T429 435T477 418Q521 397 550 357T579 260T548 151T471 65T374 11T279 -10H275L251 -105Q245 -128 238 -160Q230 -192 227 -198T215 -205H209Q189 -205 189 -198Q189 -193 211 -103L234 -11Q234 -10 226 -10Q221 -10 206 -8T161 6T107 36T62 89T43 171Q43 231 76 284T157 370T254 422T342 441Q347 441 348 445L378 567Q409 686 409 688ZM122 150Q122 116 134 91T167 53T203 35T237 27H244L337 404Q333 404 326 403T297 395T255 379T211 350T170 304Q152 276 137 237Q122 191 122 150ZM500 282Q500 320 484 347T444 385T405 400T381 404H378L332 217L284 29Q284 27 285 27Q293 27 317 33T357 47Q400 66 431 100T475 170T494 234T500 282Z"></path><path id="MJX-9-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D719" xlink:href="#MJX-9-TEX-I-1D719"></use></g><g data-mml-node="TeXAtom" transform="translate(629,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-9-TEX-I-1D457"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mrow data-mjx-texclass="ORD"><mi>j</mi></mrow></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">\phi_{j}</script><span> denotes the intermediate features from the </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.932ex" height="1.957ex" role="img" focusable="false" viewBox="0 -661 412 865" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.462ex;"><defs><path id="MJX-10-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-10-TEX-I-1D457"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">j</script><span>-th layer. </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="6.345ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2804.7 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-11-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-11-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-11-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-11-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-11-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-11-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-11-TEX-I-1D451"></use></g><g data-mml-node="mo" transform="translate(520,0)"><use data-c="28" xlink:href="#MJX-11-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(909,0)"><use data-c="1D465" xlink:href="#MJX-11-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(1481,0)"><use data-c="2C" xlink:href="#MJX-11-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(1925.7,0)"><use data-c="1D466" xlink:href="#MJX-11-TEX-I-1D466"></use></g><g data-mml-node="mo" transform="translate(2415.7,0)"><use data-c="29" xlink:href="#MJX-11-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">d(x, y)</script><span> is the L1-distance between </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.294ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 572 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-12-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-12-TEX-I-1D465"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">x</script><span> and </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.109ex" height="1.464ex" role="img" focusable="false" viewBox="0 -442 490 647" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.464ex;"><defs><path id="MJX-13-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D466" xlink:href="#MJX-13-TEX-I-1D466"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">y</script><span>, and </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.166ex" height="2.236ex" role="img" focusable="false" viewBox="0 -694 957.3 988.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.666ex;"><defs><path id="MJX-14-TEX-I-1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path><path id="MJX-14-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D706" xlink:href="#MJX-14-TEX-I-1D706"></use></g><g data-mml-node="TeXAtom" transform="translate(616,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-14-TEX-I-1D457"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>λ</mi><mrow data-mjx-texclass="ORD"><mi>j</mi></mrow></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">\lambda_{j}</script><span> is the balancing weight for each layer. </span></p></blockquote><p><span>方式一：用预训练的VGG的第1，3，5，9和13层。但NTIRE的</span><a href='https://arxiv.org/pdf/2205.07514.pdf'><span>文章</span></a><span>发现这样PSNR不升反降。</span></p><p><span>方式二：</span><a href='https://arxiv.org/pdf/2205.07514.pdf'><span>文章</span></a><span>可视化分析发现 ：</span></p><p><span>深层的特征可以提高真实感知质量方面的性能，因为它提供了更多的语义指导。 来自浅层的特征保留了更准确的细节和纹理，这对于面向 PSNR 的模型至关重要。</span></p><p><span>由于NTIRE比赛是以PSNR为评价指标，该方法便只利用了VGG浅层。</span></p><p><span>然后ReLU函数是无界的（导致监督较弱），激活的特征图是稀疏的（导致信息丢失）。以往的做法是选择ReLU前的特征做损失。</span></p><p><span>该文则使用Tanh替换ReLU。但由于VGG是以ReLU训练的，直接替换效果难以保证。一些</span><a href='https://www.cvmart.net/community/detail/4507'><span>工作</span></a><span>表明，具有良好架构的随机初始化网络足以捕获感知细节。所以该文构建了一个随机初始化的两层特征提取器：Conv k3s1-Tanh-Conv k3s1。</span></p><p>&nbsp;</p><h2 id='因果推理和稳定学习'><span>因果推理和稳定学习</span></h2><h4 id='背景'><span>背景</span></h4><h5 id='现状分析'><span>现状分析</span></h5><p><span>AI开始涉足越来越多风险敏感的领域（Performance Driven → Risk Sensitive），比如医疗、金融、交通、法律、军事等。</span></p><p><span>而现在的AI严重缺失可解释性、稳定性（I.I.D假设→OOD）。</span></p><p><span>一个合理的原因是，</span><strong><span>AI倚赖“相互关系”（Correlation）</span></strong><span>，而相互关系是很难解释的、不稳定的。</span></p><h5 id='相互关系'><span>相互关系</span></h5><p><span>以T和Y为例：</span></p><p><span>因果（Causation）T→Y</span></p><p><span>混淆（Confounding）X→T and X→Y, Ignoring X</span></p><p><span>偏差（Sample Selection Bias）T→S and Y→S, Conditional on S</span></p><p><img src="../../images/typora-images/image-20220505175620650.png" alt="image-20220505175620650" style="zoom:20%;" /><span> </span></p><p><span>只有因果关系是稳定、可解释的，而混淆与偏差是站不住脚的。</span></p><p><strong><span>因果关系 定义：</span></strong><span>保持其他一切不变时，当且仅当改变 T 导致 Y 改变时，T 导致 Y。</span></p><p><span>T causes Y if and only if changing T leads to a change in Y, while keeping everything else constant.</span></p><p><strong><span>因果效应 定义</span></strong><span>：单位T的变化能导致Y变化的量。</span></p><p><font color="red"><span>将因果关系引入学习的好处：更具可解释性，且更稳定。</span></font></p><h5 id='因果模型和基于学习的模型'><span>因果模型和基于学习的模型</span></h5><ol start='' ><li><span>如何评价因果？ 这是个哲学问题。</span></li><li><span>真实环境：高维、高噪声、少先验</span></li><li><span>不同目标：理解 vs. 预测</span></li></ol><p><span>  如何连接因果模型和基于学习的模型</span></p><p>&nbsp;</p><h4 id='因果推断'><span>因果推断</span></h4><h5 id='第一种范式'><span>第一种范式</span></h5><p><span>结构化图模型，优点是很强的表达能力，缺点是复杂度很高。更偏生成能力。</span></p><h5 id='第二种范式'><span>第二种范式</span></h5><p><span>潜在结果模型，优点是设置简单，缺点是假设太强，假设所有的混淆关系都已知。更偏判别能力。</span></p><p><span>就是现在药企做的控制变量法，一组吃药，一组吃安慰剂：</span></p><p><span>因果效应计算：ATE(Average Causal Effect) = E[Y(T=1) - Y(T=0)]</span></p><p><span>这类实验的黄金法则是：</span><strong><span>随机</span></strong><span>实验，比如实验对象分组时采样要随机。即尽量控制混淆效应是一样的。</span></p><p><span>例子：</span></p><p><img src="../../images/typora-images/image-20220506151410873.png" alt="image-20220506151410873" style="zoom:20%;" /><span> </span></p><p><span>如果直接认为这里抽烟起到了作用，那是不对的，因为往往年龄越大的人烦恼越多越倾向于抽烟。</span></p><p><span>题外话：做实验不能让未成年抽烟。所以该方法①昂贵 ②可能不符合伦理道德 ③可能不现实。 </span></p><p><span>启发：</span><font color="purple"><strong><span>Balancing Confounders&#39; Distribution</span></strong></font></p><h5 id='范式下的几种方法'><span>范式下的几种方法</span></h5><p><span>X=草坪</span></p><p><span>T是否有肉鼻子 = 1或0</span></p><p><span>Y是否是狗狗</span></p><ol start='' ><li><p><span>Matching（匹配）</span></p><p><span>也是平衡混淆关系的分布(Balancing Confounders&#39; Distribution)，比如对于肉鼻子的在草坪的动物，都能找到对照组的一个没有肉鼻子的在草坪的动物（对应物）。如果找不到对应物，就丢弃该样本。</span></p><p><span>公式化定义：Distance(Xi, Xj) &lt; ε</span></p><p><span>也就是保证Confounders近似恒定。</span></p><p><span>缺点：① ε设置很小时，可用的数据集会瘦身很小 ② 适合低维设置，但对于高维设置，很难做匹配。</span></p></li><li><p><span>Propensity Score（倾向得分）</span></p><p><span>比如一个在草坪的动物有肉鼻子的概率就叫做倾向得分e(X) = P(T=1|X)</span></p><p><span>上面我们知道对高维设置很难做匹配，所以这里我们就只对两个倾向得分做匹配。</span></p><p><span>不过倾向得分是没法观测到的，我们需要估计。</span></p><p><span>我们可以用有监督学习：已知每个样本是否有肉鼻子。所以在草坪的动物有肉鼻子的概率是知道的。</span></p><p><span>最终就可以用倾向得分来匹配距离：</span></p><p><span>Distance(Xi, Xj) = |e(Xi) - e(Xj)|</span></p><p><span>对于一个有肉鼻子的草坪上的动物，可以找对照组的一个没有肉鼻子的在人类怀抱的动物（假设在草坪和在人类怀抱的动物有肉鼻子的概率相同）</span></p></li><li><p><span>Directly Confounder Balancing</span></p></li></ol><h5><span> </span></h5></div></div>

<script>(function (){var t=document.body.parentElement,e=[],n=null,i=document.body.classList.contains("typora-export-collapse-outline"),r=function(t,e,n){document.addEventListener(t,function(t){if(!t.defaultPrevented)for(var i=t.target;i&&i!=this;i=i.parentNode)if(i.matches(e)){!1===n.call(i,t)&&(t.preventDefault(),t.stopPropagation());break}},!1)};function o(){return t.scrollTop}r("click",".outline-expander",function(t){var e=this.closest(".outline-item-wrapper").classList;return e.contains("outline-item-open")?e.remove("outline-item-open"):e.add("outline-item-open"),c(),!1}),r("click",".outline-item",function(t){var e=this.querySelector(".outline-label");if(location.hash="#"+e.getAttribute("href"),i){var n=this.closest(".outline-item-wrapper").classList;n.contains("outline-item-open")||n.add("outline-item-open"),l(),n.add("outline-item-active")}});var a,s,u=function(){var t=o();n=null;for(var i=0;i<e.length&&e[i][1]-t<60;i++)n=e[i]},l=function(){document.querySelectorAll(".outline-item-active").forEach(t=>t.classList.remove("outline-item-active")),document.querySelectorAll(".outline-item-single.outline-item-open").forEach(t=>t.classList.remove("outline-item-open"))},c=function(){if(n){l();var t=document.querySelector('.outline-label[href="#'+(CSS.escape?CSS.escape(n[0]):n[0])+'"]');if(t)if(i){var e=t.closest(".outline-item-open>ul>.outline-item-wrapper");if(e)e.classList.add("outline-item-active");else{for(var r=(t=t.closest(".outline-item-wrapper")).parentElement.closest(".outline-item-wrapper");r;)r=(t=r).parentElement.closest(".outline-item-wrapper");t.classList.add("outline-item-active")}}else t.closest(".outline-item-wrapper").classList.add("outline-item-active")}};window.addEventListener("scroll",function(t){a&&clearTimeout(a),a=setTimeout(function(){u(),c()},300)});var f=function(){s=setTimeout(function(){!function(){e=[];var t=o();document.querySelector("#write").querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(n=>{var i=n.getAttribute("id");e.push([i,t+n.getBoundingClientRect().y])})}(),u(),c()},300)};window.addEventListener("resize",function(t){s&&clearTimeout(s),f()}),f()})();</script></body>
</html>