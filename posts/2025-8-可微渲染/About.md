# BFM 与 FLAME 

## 1. 背景
在人脸建模和人脸重建任务中，**3D形状模型（3D Morphable Models, 3DMMs）** 是一个核心方法。  
它们通过统计学习的方法，用 PCA 或更复杂的参数化模型来表示人脸的几何形状和外观变化。  
其中，**BFM** 和 **FLAME** 是两类经典的人脸 3DMM 模型。

---

## 2. BFM (Basel Face Model)

### 🔹 基本信息
- **提出时间**：2009 年（Paysan et al.）
- **类型**：传统 PCA 基的人脸 3DMM
- **数据来源**：约 200 个高质量的 3D 人脸扫描（瑞士巴塞尔大学收集）
- **参数化方式**：形状和纹理通过 PCA 表示  

### 🔹 模型表示
- **形状模型**：  

$$
S = \bar{S} + A_{id}\alpha + A_{exp}\beta
$$

  - $\bar{S}$：平均人脸形状  
  - $A_{id}\alpha$：身份相关变化  
  - $A_{exp}\beta$：表情相关变化  

- **纹理模型**：  

$$
T = \bar{T} + A_{tex}\gamma
$$

### 🔹 主要贡献
- 首个被广泛使用的高质量 3D 人脸模型，推动了 3D 人脸重建、识别、动画的发展。  
- 提供了**形状-表情-纹理**的解耦表示。  
- 广泛用于 **单张图像到 3D 人脸重建**（比如 fitting-based 方法）。

### 🔹 局限性
- 数据规模有限（仅 200 个扫描）。  
- 仅靠 PCA，表达能力有限，对极端人脸和细节建模不足。  

---

## 3. FLAME (Faces Learned with an Articulated Model and Expressions)

### 🔹 基本信息
- **提出时间**：2017 年（Li et al.，MPI）
- **类型**：统计形状模型 + 关节驱动的可变形模型  
- **数据来源**：数千个高质量的 3D 扫描（涵盖更多表情和姿态）  
- **目标**：建立一个既能表示多样化表情，又能和骨骼动画兼容的 3DMM  

### 🔹 模型表示
- **FLAME 结构**结合了：
  1. **身份形状空间**（Identity shape space）  
  2. **表情空间**（Expression space, learned from blendshapes）  
  3. **姿态依赖校正**（Pose-dependent corrective blendshapes，用于自然化关节驱动的面部运动）  

- 数学形式：  

$$
V = W(T(\beta, \theta, \psi), J(\beta), \theta, W)
$$

  - $\beta$：身份参数  
  - $\theta$：姿态参数（下颌、眼睛、脖子等关节）  
  - $\psi$：表情参数  
  - $W$：蒙皮权重  
  - $T$：模板 + blendshape  

### 🔹 主要贡献
- **结合了人脸建模与骨骼动画** → 可直接嵌入动画管线。  
- 支持 **全头（包括颈部和耳朵）**，比 BFM 更完整。  
- 更好地表示大范围表情和关节驱动效果。  
- 在影视、虚拟现实、数字人等领域应用更广。  

### 🔹 局限性
- 模型参数较复杂，相比 BFM 更难拟合。  
- 数据规模依赖大规模 3D 扫描。  

> [!NOTE]
>
> 📝 BFM/FLAME 建模流程
>
> - **扫描**：获取高质量 3D 人脸网格（geometry + texture）。  
> - **预处理**：清理、对齐、非刚性配准 → 统一拓扑。  
> - **建模**：统计学习  
>   - BFM → PCA 建模 (形状/纹理/表情)。  
>   - FLAME → 身份+表情（Blendshape）+姿态修正 + 骨骼驱动。  
> - **产物**：参数化 3DMM 模型（均值 和 基向量），通常封装为 **.mat / .npz / 专用接口**。  
> - **我们关心的**：只需理解/使用最终的建模方式，不必自己做扫描和配准。

---

## 4. BFM vs FLAME 对比表

| 特性             | BFM (2009)           | FLAME (2017)                 |
| ---------------- | -------------------- | ---------------------------- |
| **数据规模**     | ~200 人              | 数千人                       |
| **表示方式**     | PCA (形状+纹理+表情) | 身份 + 表情 + 姿态依赖修正   |
| **表情建模**     | PCA 表情             | Blendshape + 姿态修正        |
| **是否包含全头** | 不完整（主要脸部）   | 完整头部（含颈、耳）         |
| **应用场景**     | 人脸重建、识别       | 动画、虚拟人、VR/AR、影视    |
| **优点**         | 简单，拟合容易       | 表达力强，更自然，更适合动画 |
| **局限性**       | 数据少，表达力有限   | 参数复杂，拟合难度高         |

---

## 5. 总结
- **BFM**：开创性的 3DMM，简单有效，适合学习和研究。  
- **FLAME**：更现代化、更强大，适合实际应用（动画/虚拟人）。  
- 学习路径：建议先理解 **BFM 的 PCA 形式**，再进阶到 **FLAME 的 blendshape + 骨骼动画机制**。  

> [!NOTE]
>
> Fitting（拟合）
>
> - **定义**：优化 3DMM 的参数，使得重建结果与观测数据（图像/landmarks/深度）尽可能一致。  
> - **常见方法**：
>   - Landmark fitting（利用 2D 人脸关键点）  
>   - Photometric fitting（利用像素光照一致性）  
>   - Hybrid fitting（综合几种约束）  
> - **结果**：得到一组个体化参数，生成与输入数据匹配的 3D 人脸。  
>
> 👉 比如：给一张照片 → 找到这张脸对应的 3D 参数。  
>
> Tracking（跟踪）
>
> - **定义**：在视频中逐帧做 fitting，同时保证时间上的平滑性。  
> - **关键点**：
>   - 保持参数在帧与帧之间的连续性（防止抖动）。  
>   - 可以结合卡尔曼滤波、光流或深度学习方法提升稳定性。  
> - **结果**：得到视频序列中连续的 3D 人脸参数轨迹（可驱动动画）。  
>
> 👉 比如：给一段视频 → 实时跟踪脸部 3D 参数变化。  



# Flame_PyTorch仓库



# SMIRK仓库

https://flame.is.tue.mpg.de/

基于FLAME2020